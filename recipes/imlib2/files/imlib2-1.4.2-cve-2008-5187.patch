diff -up imlib2-1.4.2/src/modules/loaders/loader_xpm.c.cve-2008-5187 imlib2-1.4.2/src/modules/loaders/loader_xpm.c
--- imlib2-1.4.2/src/modules/loaders/loader_xpm.c.cve-2008-5187	2008-11-23 11:10:05.000000000 +0100
+++ imlib2-1.4.2/src/modules/loaders/loader_xpm.c	2008-11-23 11:10:38.000000000 +0100
@@ -253,8 +253,8 @@ load(ImlibImage * im, ImlibProgressFunct
                                  return 0;
                               }
                             ptr = im->data;
-                            end = ptr + (sizeof(DATA32) * w * h);
                             pixels = w * h;
+                            end = ptr + pixels;
                          }
                        else
                          {
