#! /bin/bash

set -x

W_=${W:-tmp}
export -n W_
case $W_ in
  /*)	;;
  *)	W_=@abs_top_builddir@/$W_;;
esac

_s=$W_/sysroots/`uname -m`-linux
: ${PYTHON:=@PYTHON@}
PATH=$PATH:/usr/local/sbin:/usr/sbin:/sbin:$_s/usr/bin
CCACHE_DIR=$W_/cache/ccache
INSTALL='@INSTALL@'
BBPATH=@abs_top_builddir@
ELITO_METRICS_ID=$$
ELITO_PROJECT_NAME='@PROJECT_NAME@'
ELITO_SCRIPTS_DIR='@abs_top_srcdir@/scripts'

@ENABLE_CGROUPS_TRUE@ELITO_CGROUP_NAME="elito_@PROJECT_NAME@"
@ENABLE_CGROUPS_FALSE@ELITO_CGROUP_NAME=

for i in "${!_@}" \
    ENV OPTS MAKEFLAGS MAKEOVERRIDES POSIXLY_CORRECT \
    ACLOCAL_FLAGS OSTYPE HOSTTYPE ARCH CPU BOARD VENDOR SOC \
    LD_LIBRARY_PATH LD_PRELOAD MAIL MAILCHECK MAILPATH \
    DIRSTACK OPTERR OPTIND SHLVL HOST HOSTFILE \
    PKG_CONFIG_PATH PYTHONSTARTUP PROFILEREAD \
; do
	eval unset "$i"
done

export ELITO_METRICS_ID
export CCACHE_DIR BBPATH

for f in @abs_top_builddir@/set-env.local $HOME/.elito-set-env; do
    test -r "$f" || continue
    . "$f"
done
